import{r as a,j as e}from"./index-DjLJklN1.js";import{P}from"./PageContainer-DXCsbuaA.js";import{a as I,B as L}from"./BlankCard-Bi5qHtB0.js";import{C as o}from"./CustomFormLabel-YcVEnupk.js";import{C as n}from"./CustomTextField-SbTLgMVA.js";import{G}from"./Grid-CboDolct.js";import{S as x}from"./Stack-NByccG3l.js";import{B as O,T as $}from"./Box-Ceze8w59.js";import{A as R}from"./Autocomplete-rOxPlZHL.js";import{T as N}from"./TextField-BLFWIern.js";import{c as T}from"./Button-7Ql2xwQA.js";import"./index.esm-Ckl_97PH.js";import"./Grid2-C7BmHvXf.js";import"./List-BYtwvu4r.js";import"./Card-Bn8FUNEZ.js";import"./createStack-BE4hiCiQ.js";import"./Select-CmYIInra.js";import"./useSlot-oTH9YaFV.js";import"./Close-NdfeGcxT.js";import"./IconButton-D01K5F2W.js";import"./Popper-Cr7FSbl5.js";import"./createPopper-DM_rq4rS.js";import"./ListSubheader-CIu0rnsP.js";import"./Chip-DGxUr5go.js";const _=[{to:"/",title:"Écoles"},{title:"Ajouter une école"}],pe=()=>{const i="https://safeschooldata-6d63cd50a8a3.herokuapp.com",[W,j]=a.useState([]),[k,C]=a.useState([]),[c,v]=a.useState(""),[u,S]=a.useState(""),[m,y]=a.useState(""),[p,A]=a.useState(""),[d,b]=a.useState(""),[h,E]=a.useState(""),[g,w]=a.useState(null),[f,B]=a.useState(null);a.useEffect(()=>{(async()=>{try{const[r,s]=await Promise.all([fetch(`${i}/api/region/`),fetch(`${i}/api/school-categories/`)]),l=await r.json(),D=await s.json();j(Array.isArray(l.results)?l.results:[]),C(Array.isArray(D.results)?D.results:[])}catch(r){console.error("Erreur chargement régions/catégories",r),j([]),C([])}})()},[i]);const F=async t=>{if(t.preventDefault(),!c||!u||!m||!p||!d||!h||!g||!f)return alert("Veuillez remplir tous les champs obligatoires !");const r=new FormData;r.append("num_affect",c),r.append("name",u),r.append("address",m),r.append("contact",p),r.append("gerant",d),r.append("num_gerant",h),r.append("region",g.id),r.append("categorie",f.id);try{const s=await fetch(`${i}/api/schools/`,{method:"POST",body:r});if(!s.ok){const l=await s.json();return console.error(l),alert("Erreur lors de la création")}alert("École créée avec succès !"),v(""),S(""),y(""),A(""),b(""),E(""),w(null),B(null)}catch(s){console.error(s),alert("Erreur serveur")}};return e.jsxs(P,{title:"Ajouter une école",children:[e.jsx(I,{title:"Écoles",items:_}),e.jsxs("form",{onSubmit:F,children:[e.jsx(G,{container:!0,spacing:3,children:e.jsx(G,{item:!0,lg:8,xs:12,children:e.jsx(x,{spacing:3,children:e.jsx(L,{children:e.jsxs(O,{p:3,children:[e.jsx($,{variant:"h5",children:"Informations de l'école"}),e.jsxs(x,{spacing:2,mt:2,children:[e.jsx(o,{children:"Numéro Affectation *"}),e.jsx(n,{value:c,onChange:t=>v(t.target.value),fullWidth:!0}),e.jsx(o,{children:"Nom *"}),e.jsx(n,{value:u,onChange:t=>S(t.target.value),fullWidth:!0}),e.jsx(o,{children:"Adresse *"}),e.jsx(n,{value:m,onChange:t=>y(t.target.value),fullWidth:!0}),e.jsx(o,{children:"Contact *"}),e.jsx(n,{value:p,onChange:t=>A(t.target.value),fullWidth:!0}),e.jsx(o,{children:"Gérant *"}),e.jsx(n,{value:d,onChange:t=>b(t.target.value),fullWidth:!0}),e.jsx(o,{children:"Num Gérant *"}),e.jsx(n,{value:h,onChange:t=>E(t.target.value),fullWidth:!0}),e.jsx(o,{children:"Région *"}),e.jsx(R,{options:W,getOptionLabel:t=>t.name||"",value:g,onChange:(t,r)=>w(r),renderInput:t=>e.jsx(N,{...t,label:"Sélectionner une région"})}),e.jsx(o,{children:"Catégorie *"}),e.jsx(R,{options:k,getOptionLabel:t=>t.name||"",value:f,onChange:(t,r)=>B(r),renderInput:t=>e.jsx(N,{...t,label:"Sélectionner une catégorie"})})]})]})})})})}),e.jsxs(x,{direction:"row",spacing:2,mt:3,children:[e.jsx(T,{type:"submit",variant:"contained",children:"Enregistrer"}),e.jsx(T,{type:"button",variant:"outlined",color:"error",children:"Annuler"})]})]})]})};export{pe as default};
