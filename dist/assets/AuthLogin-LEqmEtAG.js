import{f as b,r as s,j as e}from"./index-B6sDybhi.js";import{C as p}from"./CustomTextField-x3HjZ-Ln.js";import{C as u}from"./CustomFormLabel-IWlY8fjR.js";import{T as a,B as i}from"./Box-DPWK2j67.js";import{D as w}from"./Divider-BpUiWfXp.js";import{S as A}from"./Stack-BzGEmwue.js";import{B as x}from"./Button-BJlF4RCP.js";import{D as E,a as F}from"./DialogContent-Zs42d3yn.js";import{D as T}from"./DialogTitle-DmwWc6sf.js";import{D as k}from"./DialogActions-CoGaUTuG.js";const P=({title:f,subtitle:g,subtext:j})=>{const c=b(),[d,S]=s.useState(""),[m,y]=s.useState(""),[v,l]=s.useState(""),[C,o]=s.useState(!1),[h,n]=s.useState(!1),D=async()=>{n(!0),l("");try{const t=await fetch("https://safeschooldata-6d63cd50a8a3.herokuapp.com/auth/jwt/create/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,password:m})}),r=await t.json();if(!t.ok){l(r.detail||"Erreur de connexion"),o(!0),n(!1);return}localStorage.setItem("access",r.access),localStorage.setItem("refresh",r.refresh),localStorage.setItem("user",JSON.stringify({id:r.id,first_name:r.first_name,last_name:r.last_name,email:r.email})),n(!1),c("/dashboards/modern")}catch{l("Erreur serveur. Veuillez réessayer."),o(!0),n(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(a,{fontWeight:"700",variant:"h4",textAlign:"center",mb:1,sx:{letterSpacing:"0.5px"},children:f}),e.jsx(a,{textAlign:"center",children:j}),e.jsx(i,{mt:3,mb:3,children:e.jsx(w,{children:e.jsx(a,{variant:"subtitle2",color:"textSecondary",children:"Front Office"})})}),e.jsxs(A,{spacing:2,children:[e.jsxs(i,{children:[e.jsx(u,{htmlFor:"email",children:"Adresse email"}),e.jsx(p,{id:"email",variant:"outlined",fullWidth:!0,value:d,onChange:t=>S(t.target.value)})]}),e.jsxs(i,{children:[e.jsx(u,{htmlFor:"password",children:"Mot de passe"}),e.jsx(p,{id:"password",type:"password",variant:"outlined",fullWidth:!0,value:m,onChange:t=>y(t.target.value)})]}),e.jsx(a,{component:"span",fontWeight:"500",sx:{textDecoration:"none",color:"primary.main",textAlign:"right",mt:1,cursor:"pointer"},onClick:()=>c("/auth/forgot-password"),children:"Mot de passe oublié ?"})]}),e.jsx(i,{mt:3,children:e.jsx(x,{color:"primary",variant:"contained",size:"large",fullWidth:!0,onClick:D,disabled:h,sx:{py:1.5,fontWeight:600,borderRadius:3,textTransform:"none"},children:h?"Connexion...":"Se connecter"})}),g,e.jsxs(E,{open:C,onClose:()=>o(!1),children:[e.jsx(T,{children:"Erreur de connexion"}),e.jsx(F,{children:e.jsx(a,{children:v})}),e.jsx(k,{children:e.jsx(x,{onClick:()=>o(!1),color:"primary",children:"Fermer"})})]})]})};export{P as A};
