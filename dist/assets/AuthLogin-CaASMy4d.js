import{f as E,r,j as e}from"./index-DjLJklN1.js";import{C as u}from"./CustomTextField-SbTLgMVA.js";import{C as x}from"./CustomFormLabel-YcVEnupk.js";import{T as o,B as i}from"./Box-Ceze8w59.js";import{D as F}from"./Divider-CXxq8pBL.js";import{S as P}from"./Stack-NByccG3l.js";import{I as T}from"./InputAdornment-0ZWWJbaf.js";import{I as O}from"./IconButton-D01K5F2W.js";import{V as W,a as B}from"./VisibilityOff-2pi-XrKP.js";import{c as f}from"./Button-7Ql2xwQA.js";import{D as L,a as M}from"./DialogContent-CtWUWdOy.js";import{D as V}from"./DialogTitle-C2EZfcf5.js";import{D as _}from"./DialogActions-BN6EYxeK.js";const Z=({title:g,subtitle:j,subtext:S})=>{const d=E(),[m,w]=r.useState(""),[h,y]=r.useState(""),[l,C]=r.useState(!1),[D,c]=r.useState(""),[v,a]=r.useState(!1),[p,n]=r.useState(!1),b="https://safeschooldata-6d63cd50a8a3.herokuapp.com",A=()=>C(!l),k=t=>t.preventDefault(),I=async()=>{n(!0),c("");try{const t=await fetch(`${b}/auth/jwt/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:m,password:h})}),s=await t.json();if(!t.ok){c(s.detail||"Erreur de connexion"),a(!0),n(!1);return}localStorage.setItem("access",s.access),localStorage.setItem("refresh",s.refresh),localStorage.setItem("user",JSON.stringify({id:s.id,first_name:s.first_name,last_name:s.last_name,email:s.email})),n(!1),d("/dashboards")}catch{c("Erreur serveur. Veuillez réessayer."),a(!0),n(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(o,{fontWeight:"700",variant:"h4",textAlign:"center",mb:1,sx:{letterSpacing:"0.5px"},children:g}),e.jsx(o,{textAlign:"center",children:S}),e.jsx(i,{mt:3,mb:3,children:e.jsx(F,{children:e.jsx(o,{variant:"subtitle2",color:"textSecondary",children:"Front Office"})})}),e.jsxs(P,{spacing:2,children:[e.jsxs(i,{children:[e.jsx(x,{htmlFor:"email",children:"Adresse email"}),e.jsx(u,{id:"email",variant:"outlined",fullWidth:!0,value:m,onChange:t=>w(t.target.value)})]}),e.jsxs(i,{children:[e.jsx(x,{htmlFor:"password",children:"Mot de passe"}),e.jsx(u,{id:"password",variant:"outlined",fullWidth:!0,type:l?"text":"password",value:h,onChange:t=>y(t.target.value),InputProps:{endAdornment:e.jsx(T,{position:"end",children:e.jsx(O,{onClick:A,onMouseDown:k,edge:"end",children:l?e.jsx(W,{}):e.jsx(B,{})})})}})]}),e.jsx(o,{component:"span",fontWeight:"500",sx:{textDecoration:"none",color:"primary.main",textAlign:"right",mt:1,cursor:"pointer"},onClick:()=>d("/auth/forgot-password"),children:"Mot de passe oublié ?"})]}),e.jsx(i,{mt:3,children:e.jsx(f,{color:"primary",variant:"contained",size:"large",fullWidth:!0,onClick:I,disabled:p,sx:{py:1.5,fontWeight:600,borderRadius:3,textTransform:"none"},children:p?"Connexion...":"Se connecter"})}),j,e.jsxs(L,{open:v,onClose:()=>a(!1),children:[e.jsx(V,{children:"Erreur de connexion"}),e.jsx(M,{children:e.jsx(o,{children:D})}),e.jsx(_,{children:e.jsx(f,{onClick:()=>a(!1),color:"primary",children:"Fermer"})})]})]})};export{Z as A};
