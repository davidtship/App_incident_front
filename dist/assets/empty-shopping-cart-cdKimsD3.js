import{r,j as se}from"./index-B6sDybhi.js";import{u as v,g as F,p as ce,d as ae,a as G}from"./globalFetcher-CB07_BEA.js";const oe=r.createContext({}),de=({children:N})=>{const[o,n]=r.useState([]),[x,D]=r.useState(""),[m,p]=r.useState("All"),[L,g]=r.useState("newest"),[a,C]=r.useState("All"),[S,f]=r.useState("All"),[y,P]=r.useState("All"),[B,c]=r.useState(!0),[j,R]=r.useState(null),[i,h]=r.useState(()=>{if(typeof window<"u"){const e=localStorage.getItem("cartItems");return e?JSON.parse(e):[]}else return[]}),{data:w,isLoading:d,error:A}=v("/api/data/eCommerce/ProductsData",F);r.useEffect(()=>{w?(n(w.data),c(d)):(A&&R(A),c(d))},[w,A,d]);const{data:I,isLoading:l,error:E,mutate:u}=v("/api/eCommerce/carts",F);r.useEffect(()=>{I?(h(I.data),c(l)):(E&&R(E),c(l))},[I,E,l]),r.useEffect(()=>{i&&localStorage.setItem("cartItems",JSON.stringify(i))},[i]),r.useEffect(()=>{const e=localStorage.getItem("cartItems");e&&h(JSON.parse(e))},[]);const q=e=>{const t=e.title.toLowerCase().includes(x.toLowerCase()),s=m==="All"||e.category.includes(m),ee=a==="All"||a==="0-50"&&e.price<=50||a==="50-100"&&e.price>50&&e.price<=100||a==="100-200"&&e.price>100&&e.price<=200||a==="200-99999"&&e.price>200,te=S==="All"||e.gender===S,re=y==="All"||e.colors.includes(y);return t&&s&&ee&&te&&re},J=e=>{switch(L){case"newest":return e.sort((t,s)=>new Date(s.created).getTime()-new Date(t.created).getTime());case"priceDesc":return e.sort((t,s)=>s.price-t.price);case"priceAsc":return e.sort((t,s)=>t.price-s.price);case"discount":return e.sort((t,s)=>(s.discount||0)-(t.discount||0));default:return e}},O=e=>o.find(s=>s.id===Number(e)),T=o.filter(q),b=J(T),Q=e=>p(e),Z=e=>g(e),H=e=>C(e),M=e=>f(e),W=e=>P(e),k=e=>D(e),z=async e=>{try{await u(ce("/api/data/eCommerce/add",{productId:e}))}catch(t){console.error("Error adding product to cart:",t)}},K=async e=>{await u(ae("/api/eCommerce/remove-item-carts",{id:e,action:"Increment"}))},U=async e=>{await u(G("/api/eCommerce/carts/increment-decrementqty",{id:e,action:"Increment"}))},V=async e=>{await u(G("/api/eCommerce/carts/increment-decrementqty",{id:e,action:"Decrement"}))},X=e=>{n(o.filter(t=>t.id!==e))},Y=()=>{n([])},_=(e,t)=>{n(o.map(s=>s.id===Number(e)?t:s))},$=()=>{p("All"),P("All"),f("All"),C("All"),g("newest")};return se.jsx(oe.Provider,{value:{products:o,searchProduct:x,selectedCategory:m,sortBy:L,priceRange:a,selectedGender:S,selectedColor:y,loading:B,error:j,cartItems:i,setProducts:n,setSearchProduct:D,setSelectedCategory:p,setSortBy:g,setPriceRange:C,setSelectedGender:f,setSelectedColor:P,setLoading:c,setCartItems:h,deleteProduct:X,searchProducts:k,updateSortBy:Z,updatePriceRange:H,selectCategory:Q,selectGender:M,selectColor:W,incrementQuantity:U,decrementQuantity:V,removeFromCart:K,addToCart:z,deleteAllProducts:Y,filteredAndSortedProducts:b,filterReset:$,getProductById:O,updateProduct:_},children:N})},le="/assets/empty-shopping-cart-CHZGqwZ9.svg";export{oe as P,de as a,le as e};
